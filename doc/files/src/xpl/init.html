<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../../../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>LuaDoc</h1>
<ul>
	
	<li><a href="../../../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h1>Modules</h1>
<ul>

	<li>
		<a href="../../../modules/xpl.html">xpl</a>
	</li>

	<li>
		<a href="../../../modules/xpldevice.html">xpldevice</a>
	</li>

	<li>
		<a href="../../../modules/xplfilters.html">xplfilters</a>
	</li>

	<li>
		<a href="../../../modules/xplhub.html">xplhub</a>
	</li>

	<li>
		<a href="../../../modules/xpllistener.html">xpllistener</a>
	</li>

	<li>
		<a href="../../../modules/xpllogger.html">xpllogger</a>
	</li>

	<li>
		<a href="../../../modules/xplmessage.html">xplmessage</a>
	</li>

	<li>
		<a href="../../../modules/xplnetpresence.html">xplnetpresence</a>
	</li>

	<li>
		<a href="../../../modules/xplsender.html">xplsender</a>
	</li>

</ul>



<!-- File list -->

<h1>Files</h1>
<ul>

	<li>
		<a href="../../../files/src/xpl/classes/base.html">src/xpl/classes/base.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpl/classes/xpldevice.html">src/xpl/classes/xpldevice.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpl/classes/xplfilter.html">src/xpl/classes/xplfilter.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpl/classes/xplmessage.html">src/xpl/classes/xplmessage.lua</a>
	</li>

	<li><strong>src/xpl/init.lua</strong></li>
	
	<li>
		<a href="../../../files/src/xpl/new_device_template.html">src/xpl/new_device_template.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpl/xplhub.html">src/xpl/xplhub.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpl/xpllistener.html">src/xpl/xpllistener.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xpllogger.html">src/xpllogger.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xplnetpres_conf.html">src/xplnetpres_conf.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xplnetpresence.html">src/xplnetpresence.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xplrun.html">src/xplrun.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xplrun_config.html">src/xplrun_config.lua</a>
	</li>

	<li>
		<a href="../../../files/src/xplsender.html">src/xplsender.lua</a>
	</li>

</ul>






</div> <!-- id="navigation" -->

<div id="content">

<h1>File <code>src/xpl/init.lua</code></h1>


<p>This module contains the main xPL functionality. Upon requiring it, it will load all supporting modules and classes. To use the framework you should only need to <code>require("xpl")</code> and any of your own devices (see the included device template for a quick start).<br/>&nbsp<br/>A global <code>xpl</code> will be created. Through this global the following components are accessible;<ul> <li><code><a href="xpllistener.html">xpl.listener</a></code> the network listener that will receive the messages from the network</li> <li><code><a href="../files/src/xpl/classes/base.html">xpl.classes.base</a></code> base class for all other classes</li> <li><code><a href="xplfilters.html">xpl.classes.xplfilters</a></code> implements the filters for an xPL device</li> <li><code><a href="xplmessage.html">xpl.classes.xplmessage</a></code> message object</li> <li><code><a href="xpldevice.html">xpl.classes.xpldevice</a></code> device baseclass</li> </ul> <br/>The xPL framework uses 'CopasTimer' to provide timers, events and backgroundworkers. Please consult the 'CopasTimer' documentation on how this works.</p>



<p>Copyright &copy;2011 Thijs Schreijer</p>


<p><small><b>Release:</b> Version 0.1, LuaxPL framework.</small></p>



<h2>Functions</h2>
<table class="function_list">

	<tr>
	<td class="name" nowrap><a href="#xpl.createaddress">xpl.createaddress</a>&nbsp;(vendor, device, instance)</td>
	<td class="summary">Creates an xPL address.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#xpl.send">xpl.send</a>&nbsp;(msg, ip, port)</td>
	<td class="summary">Sends an xPL message </td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#xpl.start">xpl.start</a>&nbsp;(...)</td>
	<td class="summary">Starts the loop and from there the listener, hub and devices.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#xpl.stop">xpl.stop</a>&nbsp;(...)</td>
	<td class="summary">Exits the loop and from there stops the listener, hub and devices.</td>
	</tr>

</table>




<h2>Tables</h2>
<table class="table_list">

	<tr>
	<td class="name" nowrap><a href="#const">const</a></td>
	<td class="summary">contains constants for the xPL module </td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#settings">settings</a></td>
	<td class="summary">contains the general settings for the xPL module </td>
	</tr>

</table>



<br/>
<br/>




<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="xpl.createaddress"></a><strong>xpl.createaddress</strong>&nbsp;(vendor, device, instance)</dt>
<dd>
Creates an xPL address.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>vendor</em></code>: (string) the vendor id to use in the address
	</li>
	
	<li>
	  <code><em>device</em></code>: (string) the device id to use in the address
	</li>
	
	<li>
	  <code><em>instance</em></code>: (string) the instance id to use in the address, with 2 special cases; <ul><li><code>'HOST'</code> will generated an instance id based upon the system hostname</li> <li><code>'RANDOM'</code> will generate a random instance id</li></ul>
	</li>
	
</ul>






<h3>Return value:</h3>
<ul>xPL address string, formatted as 'vendor-device.instance'</ul>



</dd>




<dt><a name="xpl.send"></a><strong>xpl.send</strong>&nbsp;(msg, ip, port)</dt>
<dd>
Sends an xPL message


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>msg</em></code>: (string) message to be sent.
	</li>
	
	<li>
	  <code><em>ip</em></code>: (string) optional, do not use, only for internal use by the hub
	</li>
	
	<li>
	  <code><em>port</em></code>: (number) optional, do not use, only for internal use by the hub
	</li>
	
</ul>






<h3>Return value:</h3>
<ul><code>true</code> if succesfull, <code>nil</code> and error otherwise</ul>



</dd>




<dt><a name="xpl.start"></a><strong>xpl.start</strong>&nbsp;(...)</dt>
<dd>
Starts the loop and from there the listener, hub and devices. This is a simple shortcut to <code>copas.loop()</code> and it takes the same parameters


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>








</dd>




<dt><a name="xpl.stop"></a><strong>xpl.stop</strong>&nbsp;(...)</dt>
<dd>
Exits the loop and from there stops the listener, hub and devices. This is a simple shortcut to <code>copas.exitloop()</code> and it takes the same parameters


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>








</dd>


</dl>




<h2><a name="tables"></a>Tables</h2>
<dl class="table">

<dt><a name="const"></a><strong>const</strong></dt>
<dd>contains constants for the xPL module<br /><br />


<h3>Fields:</h3>
<ul>
	
	<li>
	  <code><em>CAP_ADDRESS</em></code>: pattern to return the three elements of an address, no wildcards allowed
	</li>
	
	<li>
	  <code><em>CAP_FILTER</em></code>: pattern to return the 6 elements of an xPL filter, wildcards are allowed, and the '-' instead of a '.' between vendor and device is also supported (special case)
	</li>
	
	<li>
	  <code><em>CAP_MESSAGE</em></code>: pattern that returns the header information, body (as one string) and the remaining string (the remaining string can be used for the next iteration)
	</li>
	
	<li>
	  <code><em>CAP_KEYVALUE</em></code>: pattern that captures a key-value pair (must end with \n), and the remaining string (the remaining string can be used for the next iteration)
	</li>
	
	<li>
	  <code><em>CAP_SCHEMA</em></code>: pattern that captures a schema class and type from a full schema
	</li>
	
	<li>
	  <code><em>FMT_KEYVALUE</em></code>: format string for creating the message body; existing body, key, value
	</li>
	
	<li>
	  <code><em>FMT_MESSAGE</em></code>: format string for creating messages; type, hop, source, target, schema, body (hop is number, others string)
	</li>
	
</ul>


</dd>


<dt><a name="settings"></a><strong>settings</strong></dt>
<dd>contains the general settings for the xPL module<br /><br />


<h3>Fields:</h3>
<ul>
	
	<li>
	  <code><em>_DEBUG</em></code>: (boolean) set the debug flag and executes available tests at startup
	</li>
	
	<li>
	  <code><em>listenon</em></code>: unused for now
	</li>
	
	<li>
	  <code><em>listento</em></code>: ANY_LOCAL (peers within same subnet) or table with IP addresses (applies only to hub function)
	</li>
	
	<li>
	  <code><em>broadcast</em></code>: the IP address to use for broadcasting xPL messages onto the xPL network
	</li>
	
	<li>
	  <code><em>xplport</em></code>: the xPL network port, do not change! only if you want to create a private network and know what you are doing
	</li>
	
	<li>
	  <code><em>xplhub</em></code>: (boolean) should the internal hub be started
	</li>
	
	<li>
	  <code><em>netcheckinterval</em></code>: (number) interval in seconds for checking the network connection for any changes (defaults to 30).
	</li>
	
	<li>
	  <code><em>devices</em></code>: (table) table with device specific settings, <code>key</code> is device table, <code>value</code> is device specific settings. Fixed fields in the settings table are; <ul> <li><code>classname</code> (string) name of the class to create the device</li> <li><code>updatehandler</code> (function) may be called from the device when its settings have changed</li> <li><code>...</code></li> <li><code>...</code></li> </ul>
	</li>
	
</ul>


</dd>


</dl>




</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
